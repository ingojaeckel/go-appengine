<!DOCTYPE HTML>
<html>
  <head>
    <style>
    </style>
  </head>
  <body>
    <div id="container"></div>
    <script src="http://d3lp1msu2r81bx.cloudfront.net/kjs/js/lib/kinetic-v4.7.1.min.js"></script>
    <script defer="defer">
      var stage = new Kinetic.Stage({
        container: 'container',
        width: 600,
        height: 400
      });
      var layer = new Kinetic.Layer();

      var rect = new Kinetic.Rect({
        x: 0,
        y: 0,
        width: stage.getWidth(),
        height: stage.getHeight(),
        stroke: 'black',
        strokeWidth: 2
      });

      // add the shape to the layer
      layer.add(rect);

      var simpleText1 = new Kinetic.Text({
        x: 5,
        y: stage.getHeight() - 45,
        text: '[1] Player1: 10',
        fontSize: 12,
        fontFamily: 'Calibri',
        fill: 'green'
      });
      var simpleText2 = new Kinetic.Text({
        x: 5,
        y: stage.getHeight() - 30,
        text: '[2] Player2: 9',
        fontSize: 12,
        fontFamily: 'Calibri',
        fill: 'blue'
      });
      var simpleText3 = new Kinetic.Text({
        x: 5,
        y: stage.getHeight() - 15,
        text: '[3] Player3: 6',
        fontSize: 12,
        fontFamily: 'Calibri',
        fill: 'red'
      });

      var circle1 = new Kinetic.Circle({
        x: stage.getWidth() / 2,
        y: 20,
        radius: 10,
        fill: 'red',
        stroke: 'black',
        strokeWidth: 2
      });
      var circle2 = new Kinetic.Circle({
        x: 20,
        y: stage.getHeight() / 2,
        radius: 10,
        fill: 'green',
        stroke: 'black',
        strokeWidth: 2
      });
      var circle3 = new Kinetic.Circle({
        x: stage.getWidth() - 20,
        y: stage.getHeight() / 2,
        radius: 10,
        fill: 'blue',
        stroke: 'black',
        strokeWidth: 2
      });

      layer.add(circle1);
      layer.add(circle2);
      layer.add(circle3);
      layer.add(simpleText1);
      layer.add(simpleText2);
      layer.add(simpleText3);
      stage.add(layer);

      var amplitude = 150;
      var period = 2000;
      // in ms
      var centerX = stage.getWidth() / 2;

	var initialDirection = "r";
      var direction = initialDirection;

      var anim1 = new Kinetic.Animation(function(frame) {
	if ("r" == direction) {
		var canContinue = (circle1.getX() + 10 < stage.getWidth());

		if (canContinue) {
			circle1.setX(circle1.getX() + 1);
			return;
		}

		if (circle1.getY() + 10 < stage.getHeight()) {
			direction = "d";
			circle1.setY(circle1.getY() + 1);
		} else if (circle1.getX() - 10 > 0) {
			direction = "l";
			circle1.setX(circle1.getX() - 1);
		} else if (circle1.getY() - 10 > 10) {
			direction = "u";
			circle1.setY(circle1.getY() - 1);
		} else {
			console.debug("stuck");
		}
	} else if ("d" == direction) {
		var canContinue = (circle1.getY() + 10 < stage.getHeight());

		if (canContinue) {
			circle1.setY(circle1.getY() + 1);
			return;
		}

		if (circle1.getX() - 10 > 0) {
			direction = "l";
			circle1.setX(circle1.getX() - 1);
		} else if (circle1.getY() - 10 > 0) {
			direction = "u";
			circle1.setY(circle1.getY() - 1);
		} else if (circle1.getX() + 10 < stage.getWidth()) {
			direction = "r";
			circle1.setX(circle1.getX() + 1);
		} else {
			console.debug("stuck");
		}
	} else if ("l" == direction) {
		var canContinue = (circle1.getX() - 10 > 0);

		if (canContinue) {
			circle1.setX(circle1.getX() - 1);
			return;
		}

		if (circle1.getY() - 10 > 0) {
			direction = "u";
			circle1.setY(circle1.getY() - 1);
		} else if (circle1.getX() + 10 < stage.getWidth()) {
			direction = "r";
			circle1.setX(circle1.getX() + 1);
		} else if (circle1.getY() - 10 > 0) {
			direction = "u";
			circle1.setY(circle1.getY() - 1);
		} else {
			console.debug("stuck");
		}
	} else if ("u" == direction) {
		var canContinue = (circle1.getY() - 10 > 0);

		if (canContinue) {
			circle1.setY(circle1.getY() - 1);
			return;
		}

		if (circle1.getX() + 10 < stage.getWidth()) {
			direction = "r";
			circle1.setX(circle1.getX() + 1);
		} else if (circle1.getY() + 10 > 0) {
			direction = "d";
			circle1.setY(circle1.getY() + 1);
		} else if (circle1.getX() - 10 > 0) {
			direction = "l";
			circle1.setX(circle1.getX() - 1);
		} else {
			console.debug("stuck");
		}
	} 
      }, layer);

     anim1.start();

    </script>
  </body>
</html>
